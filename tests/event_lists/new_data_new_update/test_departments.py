#
import pytest
from load_one_data import dump_diff, one_dump_test

from ArWikiCats import resolve_arabic_category_label

data = {
    "Category:Companies that have filed for bankruptcy in Canada": "تصنيف:شركات أعلنت إفلاسها في كندا",
    "Category:Clothing retailers of the United States": "تصنيف:متاجر ملابس بالتجزئة في الولايات المتحدة",
    "Category:Department stores of the United States": "تصنيف:متاجر متعددة الأقسام في الولايات المتحدة",
    "Category:Department stores of Canada": "تصنيف:متاجر متعددة الأقسام في كندا",
}

data2 = {
    "Category:Companies that have filed for bankruptcy in Brazil": "تصنيف:شركات أعلنت إفلاسها في البرازيل",
    "Category:Companies that have filed for bankruptcy in Canada": "تصنيف:شركات أعلنت إفلاسها في كندا",
    "Category:Companies that have filed for bankruptcy in Japan": "تصنيف:شركات أعلنت إفلاسها في اليابان",
    "Category:Companies that have filed for bankruptcy in South Korea": "تصنيف:شركات أعلنت إفلاسها في كوريا الجنوبية",
    "Category:Companies that have filed for bankruptcy in the People's Republic of China": "تصنيف:شركات أعلنت إفلاسها في جمهورية الصين الشعبية",
    "Category:Companies that have filed for bankruptcy in the United States": "تصنيف:شركات أعلنت إفلاسها في الولايات المتحدة",
    "Category:Clothing retailers": "تصنيف:متاجر ملابس بالتجزئة",
    "Category:Clothing retailers by country": "تصنيف:متاجر ملابس بالتجزئة حسب البلد",
    "Category:Clothing retailers of Australia": "تصنيف:متاجر ملابس بالتجزئة في أستراليا",
    "Category:Clothing retailers of Brazil": "تصنيف:متاجر ملابس بالتجزئة في البرازيل",
    "Category:Clothing retailers of Canada": "تصنيف:متاجر ملابس بالتجزئة في كندا",
    "Category:Clothing retailers of China": "تصنيف:متاجر ملابس بالتجزئة في الصين",
    "Category:Clothing retailers of Denmark": "تصنيف:متاجر ملابس بالتجزئة في الدنمارك",
    "Category:Clothing retailers of England": "تصنيف:متاجر ملابس بالتجزئة في إنجلترا",
    "Category:Clothing retailers of France": "تصنيف:متاجر ملابس بالتجزئة في فرنسا",
    "Category:Clothing retailers of Germany": "تصنيف:متاجر ملابس بالتجزئة في ألمانيا",
    "Category:Clothing retailers of Greece": "تصنيف:متاجر ملابس بالتجزئة في اليونان",
    "Category:Clothing retailers of Greenland": "تصنيف:متاجر ملابس بالتجزئة في جرينلاند",
    "Category:Clothing retailers of Hong Kong": "تصنيف:متاجر ملابس بالتجزئة في هونغ كونغ",
    "Category:Clothing retailers of Iceland": "تصنيف:متاجر ملابس بالتجزئة في آيسلندا",
    "Category:Clothing retailers of India": "تصنيف:متاجر ملابس بالتجزئة في الهند",
    "Category:Clothing retailers of Ireland": "تصنيف:متاجر ملابس بالتجزئة في أيرلندا",
    "Category:Clothing retailers of Israel": "تصنيف:متاجر ملابس بالتجزئة في إسرائيل",
    "Category:Clothing retailers of Italy": "تصنيف:متاجر ملابس بالتجزئة في إيطاليا",
    "Category:Clothing retailers of Japan": "تصنيف:متاجر ملابس بالتجزئة في اليابان",
    "Category:Clothing retailers of Lithuania": "تصنيف:متاجر ملابس بالتجزئة في ليتوانيا",
    "Category:Clothing retailers of Mexico": "تصنيف:متاجر ملابس بالتجزئة في المكسيك",
    "Category:Clothing retailers of New Zealand": "تصنيف:متاجر ملابس بالتجزئة في نيوزيلندا",
    "Category:Clothing retailers of Nigeria": "تصنيف:متاجر ملابس بالتجزئة في نيجيريا",
    "Category:Clothing retailers of Pakistan": "تصنيف:متاجر ملابس بالتجزئة في باكستان",
    "Category:Clothing retailers of Scotland": "تصنيف:متاجر ملابس بالتجزئة في إسكتلندا",
    "Category:Clothing retailers of South Africa": "تصنيف:متاجر ملابس بالتجزئة في جنوب إفريقيا",
    "Category:Clothing retailers of Spain": "تصنيف:متاجر ملابس بالتجزئة في إسبانيا",
    "Category:Clothing retailers of Sweden": "تصنيف:متاجر ملابس بالتجزئة في السويد",
    "Category:Clothing retailers of Switzerland": "تصنيف:متاجر ملابس بالتجزئة في سويسرا",
    "Category:Clothing retailers of the United Kingdom": "تصنيف:متاجر ملابس بالتجزئة في المملكة المتحدة",
    "Category:Clothing retailers of the United States": "تصنيف:متاجر ملابس بالتجزئة في الولايات المتحدة",
    "Category:Clothing retailers of Tunisia": "تصنيف:متاجر ملابس بالتجزئة في تونس",
    "Category:Clothing retailers of Wales": "تصنيف:متاجر ملابس بالتجزئة في ويلز",
    "Category:Department stores": "تصنيف:متاجر متعددة الأقسام",
    "Category:Department stores by country": "تصنيف:متاجر متعددة الأقسام حسب البلد",
    "Category:Department stores of Andorra": "تصنيف:متاجر متعددة الأقسام في أندورا",
    "Category:Department stores of Australia": "تصنيف:متاجر متعددة الأقسام في أستراليا",
    "Category:Department stores of Austria": "تصنيف:متاجر متعددة الأقسام في النمسا",
    "Category:Department stores of Brazil": "تصنيف:متاجر متعددة الأقسام في البرازيل",
    "Category:Department stores of Brunei": "تصنيف:متاجر متعددة الأقسام في بروناي",
    "Category:Department stores of Bulgaria": "تصنيف:متاجر متعددة الأقسام في بلغاريا",
    "Category:Department stores of Canada": "تصنيف:متاجر متعددة الأقسام في كندا",
    "Category:Department stores of Central America": "تصنيف:متاجر متعددة الأقسام في أمريكا الوسطى",
    "Category:Department stores of Chile": "تصنيف:متاجر متعددة الأقسام في تشيلي",
    "Category:Department stores of China": "تصنيف:متاجر متعددة الأقسام في الصين",
    "Category:Department stores of Denmark": "تصنيف:متاجر متعددة الأقسام في الدنمارك",
    "Category:Department stores of El Salvador": "تصنيف:متاجر متعددة الأقسام في السلفادور",
    "Category:Department stores of Finland": "تصنيف:متاجر متعددة الأقسام في فنلندا",
    "Category:Department stores of France": "تصنيف:متاجر متعددة الأقسام في فرنسا",
    "Category:Department stores of Germany": "تصنيف:متاجر متعددة الأقسام في ألمانيا",
    "Category:Department stores of Hong Kong": "تصنيف:متاجر متعددة الأقسام في هونغ كونغ",
    "Category:Department stores of India": "تصنيف:متاجر متعددة الأقسام في الهند",
    "Category:Department stores of Indonesia": "تصنيف:متاجر متعددة الأقسام في إندونيسيا",
    "Category:Department stores of Ireland": "تصنيف:متاجر متعددة الأقسام في أيرلندا",
    "Category:Department stores of Israel": "تصنيف:متاجر متعددة الأقسام في إسرائيل",
    "Category:Department stores of Italy": "تصنيف:متاجر متعددة الأقسام في إيطاليا",
    "Category:Department stores of Japan": "تصنيف:متاجر متعددة الأقسام في اليابان",
    "Category:Department stores of Kazakhstan": "تصنيف:متاجر متعددة الأقسام في كازاخستان",
    "Category:Department stores of Kuwait": "تصنيف:متاجر متعددة الأقسام في الكويت",
    "Category:Department stores of Lebanon": "تصنيف:متاجر متعددة الأقسام في لبنان",
    "Category:Department stores of Malaysia": "تصنيف:متاجر متعددة الأقسام في ماليزيا",
    "Category:Department stores of Mexico": "تصنيف:متاجر متعددة الأقسام في المكسيك",
    "Category:Department stores of New Zealand": "تصنيف:متاجر متعددة الأقسام في نيوزيلندا",
    "Category:Department stores of North Korea": "تصنيف:متاجر متعددة الأقسام في كوريا الشمالية",
    "Category:Department stores of Norway": "تصنيف:متاجر متعددة الأقسام في النرويج",
    "Category:Department stores of Pakistan": "تصنيف:متاجر متعددة الأقسام في باكستان",
    "Category:Department stores of Poland": "تصنيف:متاجر متعددة الأقسام في بولندا",
    "Category:Department stores of Portugal": "تصنيف:متاجر متعددة الأقسام في البرتغال",
    "Category:Department stores of Russia": "تصنيف:متاجر متعددة الأقسام في روسيا",
    "Category:Department stores of Serbia": "تصنيف:متاجر متعددة الأقسام في صربيا",
    "Category:Department stores of Singapore": "تصنيف:متاجر متعددة الأقسام في سنغافورة",
    "Category:Department stores of Slovenia": "تصنيف:متاجر متعددة الأقسام في سلوفينيا",
    "Category:Department stores of South Africa": "تصنيف:متاجر متعددة الأقسام في جنوب إفريقيا",
    "Category:Department stores of South Korea": "تصنيف:متاجر متعددة الأقسام في كوريا الجنوبية",
    "Category:Department stores of Spain": "تصنيف:متاجر متعددة الأقسام في إسبانيا",
    "Category:Department stores of Sri Lanka": "تصنيف:متاجر متعددة الأقسام في سريلانكا",
    "Category:Department stores of Sweden": "تصنيف:متاجر متعددة الأقسام في السويد",
    "Category:Department stores of Switzerland": "تصنيف:متاجر متعددة الأقسام في سويسرا",
    "Category:Department stores of Taiwan": "تصنيف:متاجر متعددة الأقسام في تايوان",
    "Category:Department stores of Thailand": "تصنيف:متاجر متعددة الأقسام في تايلاند",
    "Category:Department stores of the Netherlands": "تصنيف:متاجر متعددة الأقسام في هولندا",
    "Category:Department stores of the Philippines": "تصنيف:متاجر متعددة الأقسام في الفلبين",
    "Category:Department stores of the Soviet Union": "تصنيف:متاجر متعددة الأقسام في الاتحاد السوفيتي",
    "Category:Department stores of the United Arab Emirates": "تصنيف:متاجر متعددة الأقسام في الإمارات العربية المتحدة",
    "Category:Department stores of the United Kingdom": "تصنيف:متاجر متعددة الأقسام في المملكة المتحدة",
    "Category:Department stores of the United States": "تصنيف:متاجر متعددة الأقسام في الولايات المتحدة",
    "Category:Department stores of Turkey": "تصنيف:متاجر متعددة الأقسام في تركيا",
    "Category:Department stores of Zimbabwe": "تصنيف:متاجر متعددة الأقسام في زيمبابوي",
    "Category:Department stores on the National Register of Historic Places": "تصنيف:متاجر متعددة الأقسام في السجل الوطني للأماكن التاريخية",
    "Category:Disasters in department stores": "تصنيف:كوارث في متاجر متعددة الأقسام",
    "Category:Works set in department stores": "تصنيف:أعمال تقع أحداثها في متاجر متعددة الأقسام",
    "Category:Television shows set in department stores": "تصنيف:عروض تلفزيونية تقع أحداثها في متاجر متعددة الأقسام",
    "Category:Films set in department stores": "تصنيف:أفلام تقع أحداثها في متاجر متعددة الأقسام",
    "Category:Fiction about department stores": "تصنيف:الخيال عن متاجر متعددة الأقسام",
}
data_3 = {
    "Category:Children's clothing designers": "",
    "Category:Children's clothing retailers": "",
    "Category:Online clothing retailers": "",
    "Category:Online clothing retailers of Canada": "",
    "Category:Online clothing retailers of Germany": "",
    "Category:Online clothing retailers of India": "",
    "Category:Online clothing retailers of Italy": "",
    "Category:Online clothing retailers of Singapore": "",
    "Category:Online clothing retailers of Spain": "",
    "Category:Online clothing retailers of the United Kingdom": "",
    "Category:Online clothing retailers of the United States": "",
    "Category:Defunct clothing retailers of the United States": "",
    "Category:Defunct department stores": "",
    "Category:Defunct department stores based in Alabama": "",
    "Category:Defunct department stores based in Arizona": "",
    "Category:Defunct department stores based in Arkansas": "",
    "Category:Defunct department stores based in Atlanta": "",
    "Category:Defunct department stores based in California": "",
    "Category:Defunct department stores based in Chicago": "",
    "Category:Defunct department stores based in Cincinnati": "",
    "Category:Defunct department stores based in Cleveland": "",
    "Category:Defunct department stores based in Colorado": "",
    "Category:Defunct department stores based in Columbus, Ohio": "",
    "Category:Defunct department stores based in Connecticut": "",
    "Category:Defunct department stores based in Dayton, Ohio": "",
    "Category:Defunct department stores based in Downtown Los Angeles": "",
    "Category:Defunct department stores based in Florida": "",
    "Category:Defunct department stores based in Georgia (U.S. state)": "",
    "Category:Defunct department stores based in Greater Los Angeles": "",
    "Category:Defunct department stores based in Hawaii": "",
    "Category:Defunct department stores based in Hollywood": "",
    "Category:Defunct department stores based in Illinois": "",
    "Category:Defunct department stores based in Indiana": "",
    "Category:Defunct department stores based in Iowa": "",
    "Category:Defunct department stores based in Kentucky": "",
    "Category:Defunct department stores based in Long Beach, California": "",
    "Category:Defunct department stores based in Louisiana": "",
    "Category:Defunct department stores based in Maine": "",
    "Category:Defunct department stores based in Maryland": "",
    "Category:Defunct department stores based in Massachusetts": "",
    "Category:Defunct department stores based in Michigan": "",
    "Category:Defunct department stores based in Minnesota": "",
    "Category:Defunct department stores based in Mississippi": "",
    "Category:Defunct department stores based in Missouri": "",
    "Category:Defunct department stores based in Nebraska": "",
    "Category:Defunct department stores based in Nevada": "",
    "Category:Defunct department stores based in New Jersey": "",
    "Category:Defunct department stores based in New York City": "",
    "Category:Defunct department stores based in New York State": "",
    "Category:Defunct department stores based in North Carolina": "",
    "Category:Defunct department stores based in North Dakota": "",
    "Category:Defunct department stores based in North Hollywood": "",
    "Category:Defunct department stores based in Ohio": "",
    "Category:Defunct department stores based in Oklahoma": "",
    "Category:Defunct department stores based in Orange County, California": "",
    "Category:Defunct department stores based in Oregon": "",
    "Category:Defunct department stores based in Pennsylvania": "",
    "Category:Defunct department stores based in Philadelphia": "",
    "Category:Defunct department stores based in Pittsburgh": "",
    "Category:Defunct department stores based in Sacramento": "",
    "Category:Defunct department stores based in San Bernardino County, California": "",
    "Category:Defunct department stores based in San Diego": "",
    "Category:Defunct department stores based in South Carolina": "",
    "Category:Defunct department stores based in Southeast Los Angeles County, California": "",
    "Category:Defunct department stores based in Tennessee": "",
    "Category:Defunct department stores based in Texas": "",
    "Category:Defunct department stores based in the City of Los Angeles": "",
    "Category:Defunct department stores based in the Miracle Mile": "",
    "Category:Defunct department stores based in the San Fernando Valley": "",
    "Category:Defunct department stores based in the San Francisco Bay Area": "",
    "Category:Defunct department stores based in the San Gabriel Valley": "",
    "Category:Defunct department stores based in the South Bay, Los Angeles County": "",
    "Category:Defunct department stores based in the Westside, Los Angeles": "",
    "Category:Defunct department stores based in Toledo, Ohio": "",
    "Category:Defunct department stores based in Utah": "",
    "Category:Defunct department stores based in Virginia": "",
    "Category:Defunct department stores based in Washington, D.C.": "",
    "Category:Defunct department stores based in Washington State": "",
    "Category:Defunct department stores based in West Virginia": "",
    "Category:Defunct department stores based in Wisconsin": "",
    "Category:Defunct department stores by country": "",
    "Category:Defunct department stores of Australia": "",
    "Category:Defunct department stores of Mexico": "",
    "Category:Defunct department stores of Thailand": "",
    "Category:Defunct department stores of the United Kingdom": "",
    "Category:Defunct department stores of the United States": "",
    "Category:Defunct department stores of the United States by city": "",
    "Category:Defunct department stores of the United States by state": "",
    "Category:Department stores in Southend-on-Sea (town)": "",
    "Category:May Department Stores": ""
}


@pytest.mark.parametrize("category, expected", data.items(), ids=data.keys())
@pytest.mark.fast
def test_departments_1(category: str, expected: str) -> None:
    label = resolve_arabic_category_label(category)
    assert label == expected


@pytest.mark.parametrize("category, expected", data2.items(), ids=data2.keys())
@pytest.mark.fast
def test_departments_2(category: str, expected: str) -> None:
    label = resolve_arabic_category_label(category)
    assert label == expected


TEMPORAL_CASES = [
    ("test_departments_1", data),
    ("test_departments_2", data2),
]


@pytest.mark.parametrize("name,data", TEMPORAL_CASES)
@pytest.mark.dump
def test_all(name: str, data: dict[str, str]) -> None:
    expected, diff_result = one_dump_test(data, resolve_arabic_category_label)

    dump_diff(diff_result, name)
    assert diff_result == expected, f"Differences found: {len(diff_result):,}, len all :{len(data):,}"
